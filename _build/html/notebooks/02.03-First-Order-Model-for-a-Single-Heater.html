
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>2.3. First Order Model for a Single Heater &#8212; CBE 30338 Chemical Process Control</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.4. Model Identification for the Temperature Control Lab" href="02.04-Model-Identification.html" />
    <link rel="prev" title="2.2. Properties of Scalar First Order Linear Systems" href="02.02-Properties-of-Scalar-First-Order-Linear-Systems.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">CBE 30338 Chemical Process Control</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Readme.html">
   CBE 30338 Chemical Process Control
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Course Information
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="00.01-Schedule.html">
   Schedule and Course Organization
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Topical Materials
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="01.00-What-is-Process-Control.html">
   1. What is Process Control?
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="01.01-Elements-of-Feedback-Control.html">
     1.1. Elements of Process Control
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="01.02-Examples-of-Process-Control.html">
     1.2. Examples of Process Control
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="01.05-Assignment-1.html">
     1.3. Assignment 1
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="02.00-Process-Modeling.html">
   2. Process Modeling
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="02.01-One-Compartment-Pharmacokinetics.html">
     2.1. One Compartment Pharmacokinetics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02.02-Properties-of-Scalar-First-Order-Linear-Systems.html">
     2.2. Properties of Scalar First Order Linear Systems
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     2.3. First Order Model for a Single Heater
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02.04-Model-Identification.html">
     2.4. Model Identification for the Temperature Control Lab
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="03.00-Feedback-Control.html">
   3. Feedback Control
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="03.01-Case-Study-Thermal-Cycling-PCR.html">
     3.1. Case Study: Thermal Cycling for PCR
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03.02-Setpoints.html">
     3.2. Setpoints
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03.03-Relay-Control.html">
     3.3. Relay Control
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03.04-Implementing-Controllers.html">
     3.4. Implementing Controllers in Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03.05-Proportional-Integral-Control.html">
     3.5. Practical Proportional (P) and Proportional-Integral (PI) Control
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03.06-Lab-Assignment-PI-Control.html">
     3.6. Lab Assignment 3: Relay and PI Control
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03.07-Integral-Windup-and-Bumpless-Transfer.html">
     3.7. Integral Windup and Bumpless Transfer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03.08-Lab-Assignment-Cascade-Control.html">
     3.8. Lab Assignment 4: Cascade Control
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03.09-Lab-Assignment-Solution.html">
     3.9. Lab Assignment 4: Solution
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="04.00-Process-Analytics.html">
   4. Process Analytics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="04.01-Learning-Goals.html">
     4.1. Learning Goals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04.02-Process-Historians.html">
     4.2. Data/Process/Operational Historian
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04.03-State-Estimation-Copy1.html">
     4.3. Estimation and Anamoly Detection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04.03-State-Estimation.html">
     4.4. State Estimation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04.04-Lab-Assigment-State-Estimation.html">
     4.5. Lab Assignment 5: State Estimation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04.05-Anomaly-Detection.html">
     4.6. Anomaly Detection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04.06-Lab-Assignment-Anomaly-Detection.html">
     4.7. Lab Assignment 6: Anomaly Detection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04.07-Observer-Synthesis-LMI.html">
     4.8. Observer Synthesis using Linear Matrix Inequalities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04.08-Envrironmental-Application.html">
     4.9. Application of Luenberger Observers to Environmental Modeling of Rivers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04.09-Study-Questions.html">
     4.10. Study Questions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="05.00-Optimization.html">
   5. Optimization
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="05.01-Linear-Production-Model.html">
     5.1. Linear Production Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="05.02-Linear-Blending-Problem.html">
     5.2. Linear Blending Problems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="05.03-Homework_4.html">
     5.3. Homework Assignment 4
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="05.04-Gasoline-Blending.html">
     5.4. Gasoline Blending
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="05.05-Linear-Programming.html">
     5.5. Linear Programming
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="05.06-Design-of-a-Cold-Weather-Fuel.html">
     5.6. Design of a Cold Weather Fuel
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="05.98-Linear-Production-Model-in-Pyomo.html">
     5.7. Linear Production Model in Pyomo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="05.99-Pyomo-Examples.html">
     5.8. Pyomo Examples
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="06.00-Predictive-Control.html">
   6. Predictive Control
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="06.01-Static-Operability.html">
     6.1. Static Operability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="06.02-Simulation-and-Open-Loop-Optimal-Control.html">
     6.2. Simulation and Open-Loop Optimal Control
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="06.03-Predictive-Control.html">
     6.3. Predictive Control
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="06.04-Implementing-Predictive-Control.html">
     6.4. Implementing Predictive Control
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="06.05-Quiz-Review.html">
     6.5. Quiz Review for Chapters 5 and 6
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="07.00-Discrete-Event-Systems.html">
   7. Discrete Event Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="07.01-Introduction-to-Simpy.html">
     7.1. Introduction to Simpy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07.02-Agent-Based-Models.html">
     7.2. Agent Based Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07.03-Chemotaxis.html">
     7.3. Chemotaxis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07.04-Project-Batch-Chemical-Process.html">
     7.4. Batch Chemical Process
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07.05-Queuing-Systems-and-Poisson-Processes.html">
     7.5. Simulating Queuing Systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="08.00-Projects.html">
   8. Projects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09.00-Bibliography.html">
   9. References
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Control Laboratory
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="A.00-TCLab.html">
   Temperature Control Laboratory
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="A.01-TCLab.html">
     The Temperature Control Laboratory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="A.02-TCLab-Python-Package.html">
     The TCLab Python Package
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="B.00-Python-Tutorials.html">
   Python Tutorials
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="B.10-Animation-in-Jupyter-Notebooks.html">
     Animation in Jupyter Notebooks
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/02.03-First-Order-Model-for-a-Single-Heater.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/jckantor/cbe30338-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/jckantor/cbe30338-book/issues/new?title=Issue%20on%20page%20%2Fnotebooks/02.03-First-Order-Model-for-a-Single-Heater.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/jckantor/cbe30338-book/main?urlpath=tree/notebooks/02.03-First-Order-Model-for-a-Single-Heater.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/jckantor/cbe30338-book/blob/main/notebooks/02.03-First-Order-Model-for-a-Single-Heater.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#learning-goals">
   2.3.1. Learning Goals
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#first-order-model-for-one-heater-sensor-assembly">
   2.3.2. First-order model for one heater/sensor assembly
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#energy-balance">
     2.3.2.1. Energy Balance
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#energy-inflow">
     2.3.2.2. Energy inflow
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#energy-outflow">
     2.3.2.3. Energy Outflow
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#one-state-model">
     2.3.2.4. One-state model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#estimating-alpha">
     2.3.2.5. Estimating
     <span class="math notranslate nohighlight">
      \(\alpha\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#steady-state">
     2.3.2.6. Steady State
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#deviation-variables">
     2.3.2.7. Deviation Variables
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#first-order-linear-differential-equations">
     2.3.2.8. First Order Linear Differential Equations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#steady-state-response">
       2.3.2.8.1. Steady State Response
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#transient-response">
       2.3.2.8.2. Transient Response
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#apply-to-model-equation">
       2.3.2.8.3. Apply to Model Equation
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plotting-the-analytical-solution">
     2.3.2.9. Plotting the Analytical Solution
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#matching-the-model-to-experimental-data">
   2.3.3. Matching the Model to Experimental Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#assignment-3">
   2.3.4. Assignment 3
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="first-order-model-for-a-single-heater">
<h1><span class="section-number">2.3. </span>First Order Model for a Single Heater<a class="headerlink" href="#first-order-model-for-a-single-heater" title="Permalink to this headline">¶</a></h1>
<p><img alt="Comsol model of Temperature Control Laboratory" src="https://jckantor.github.io/cbe30338-2021/figures/arduino_comsol.png" /></p>
<div class="section" id="learning-goals">
<h2><span class="section-number">2.3.1. </span>Learning Goals<a class="headerlink" href="#learning-goals" title="Permalink to this headline">¶</a></h2>
<p>Mathematical modeling is an integral part of process control. Process models come in many forms for different purposes, ranging from the barest of information about a process to sophisticated simulation involving millions of computational nodes.</p>
<p>Our purpose here is to demonstrate simple approaches that provide with insight about the qualitative nature of process dynamics. We show how to construct simple models from first-principles understanding of the processes, and how to fit those models to experimental data.</p>
<p>In this notebook we will:</p>
<ul class="simple">
<li><p>Construct a first-order lumped model for a single heater/sensor assembly on the Temperature Control Laboratory/</p></li>
<li><p>Relate this model to the previously enountered first-order linear systems</p></li>
<li><p>Demonstrate how to estimate parameters from step test experiments.</p></li>
</ul>
</div>
<div class="section" id="first-order-model-for-one-heater-sensor-assembly">
<h2><span class="section-number">2.3.2. </span>First-order model for one heater/sensor assembly<a class="headerlink" href="#first-order-model-for-one-heater-sensor-assembly" title="Permalink to this headline">¶</a></h2>
<div class="section" id="energy-balance">
<h3><span class="section-number">2.3.2.1. </span>Energy Balance<a class="headerlink" href="#energy-balance" title="Permalink to this headline">¶</a></h3>
<p>We’ll be begin by developing a model for one of the heater/sensor assemblies located on the Temperature Control Laboratory. The basic outline of an energy balaance is given by</p>
<div class="math notranslate nohighlight">
\[\fbox{Rate of energy accumulation} = \fbox{Rate of energy in flow} - \fbox{Rate of energy outflow}\]</div>
<p>In the absence of any material flows, changes in kinetic or potential energy, or any chemical changes, changes in sensible temperature is the only form of energy accumulation. If we assume the heater/sensor assembly is at single uniform temperature <span class="math notranslate nohighlight">\(T_1\)</span>, has mass <span class="math notranslate nohighlight">\(m\)</span>, and a constant and average specific heat capacity <span class="math notranslate nohighlight">\(\hat{C}_p\)</span>,</p>
<div class="math notranslate nohighlight">
\[\fbox{Rate of energy accumulation} = m \hat{C}_p \frac{dT_1}{dt}\]</div>
<p>For the purposes of this model we will lump the mass and specific heat capacity into a single parameter representing the overall heat capacity of the assembly</p>
<div class="math notranslate nohighlight">
\[C_p = m \hat{C}_p\]</div>
<p>The final expression for the rate of energy accumulation becomes</p>
<div class="math notranslate nohighlight">
\[\fbox{Rate of energy accumulation} = C_p \frac{dT_1}{dt}\]</div>
<hr>
<p><strong>Study Question:</strong> What are the units of <span class="math notranslate nohighlight">\(C_p\)</span>?</p>
<hr></div>
<div class="section" id="energy-inflow">
<h3><span class="section-number">2.3.2.2. </span>Energy inflow<a class="headerlink" href="#energy-inflow" title="Permalink to this headline">¶</a></h3>
<p>The flow of energy into into the heater/sensor assembly is controlled by variable <span class="math notranslate nohighlight">\(u_1\)</span>, the percentage of maximum available power to the heater. As a safety feature to protect both the user and the equipment, the maximum power available to the heater is set by an Arduino parameter <span class="math notranslate nohighlight">\(P_1\)</span> specified as an 8 bit integer value between 0 and 255.</p>
<p>The actual power delivered to the heater is therefore proportional to the product <span class="math notranslate nohighlight">\(P_1u_1\)</span></p>
<div class="math notranslate nohighlight">
\[\fbox{Rate of energy in flow} \propto P_1 u_1\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
0 &amp; \leq u_1 \leq 100 \\
0 &amp; \leq P_1 \leq 255 
\end{align*}\end{split}\]</div>
<p>An experimentally parameter <span class="math notranslate nohighlight">\(\alpha\)</span> is introduced to establish the actual power delivered in units of watts</p>
<div class="math notranslate nohighlight">
\[\fbox{Rate of energy in flow} = \alpha P_1 u_1\]</div>
<hr>
<p><strong>Study Question:</strong> What are the units of <span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(P_1\)</span>, and <span class="math notranslate nohighlight">\(U_1\)</span>?</p>
<p><strong>Study Question:</strong> How would determine <span class="math notranslate nohighlight">\(\alpha\)</span> experimentally? What experiments would you perform? What equipment would you need in addition to that delivered with the Temperature Control Lab?</p>
<hr></div>
<div class="section" id="energy-outflow">
<h3><span class="section-number">2.3.2.3. </span>Energy Outflow<a class="headerlink" href="#energy-outflow" title="Permalink to this headline">¶</a></h3>
<p>Energy flows out of the assembly primarily through convective heat transfer to the surrounding environment. At the relatively low operating temperatures of the device, the amount of radiative heat transfer is neglible.</p>
<div class="math notranslate nohighlight">
\[\fbox{Rate of energy outflow} = U_a(T_1 - T_{amb})\]</div>
<p>Parameters <span class="math notranslate nohighlight">\(U_a\)</span> and <span class="math notranslate nohighlight">\(T_{amb}\)</span> are the overall heat transfer coefficient and ambient temperature, respectively.</p>
<hr>
<p><strong>Study Question:</strong> Do you agree with the assumptions embedded in this equation? What other considerations might apply?</p>
<p><strong>Study Question:</strong> What are the units of <span class="math notranslate nohighlight">\(U_a\)</span>?</p>
<p><strong>Study Question:</strong> How can you determine <span class="math notranslate nohighlight">\(T_{amb}\)</span> in experiments you do with the Temperature Control Lab?</p>
<hr></div>
<div class="section" id="one-state-model">
<h3><span class="section-number">2.3.2.4. </span>One-state model<a class="headerlink" href="#one-state-model" title="Permalink to this headline">¶</a></h3>
<p>Putting these terms together in the energy balance yields a first-order model for the response of the heater/sensor assembly on the Temperature Control Laboratory.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
C_p\frac{dT_1}{dt} &amp; = U_a(T_{amb} - T_1) + \alpha P_1u_1 \\
\end{align}\end{split}\]</div>
</div>
<div class="section" id="estimating-alpha">
<h3><span class="section-number">2.3.2.5. </span>Estimating <span class="math notranslate nohighlight">\(\alpha\)</span><a class="headerlink" href="#estimating-alpha" title="Permalink to this headline">¶</a></h3>
<p>As it happens, the parameter <span class="math notranslate nohighlight">\(\alpha\)</span> exhibits a mild temperature dependency due to the intrinisic properties of semiconductors. The following experiment sets to P1 to a value of 200 in rgw arbitrary units of the Arduino hardware, then sets U1 to 50%. The power delivered to the device is measured after reaching operating temperature.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">t_expt</span> <span class="o">=</span> <span class="mi">600</span>

<span class="n">data_file</span> <span class="o">=</span> <span class="s2">&quot;data/Model_Data.csv&quot;</span>
<span class="n">connected</span> <span class="o">=</span> <span class="kc">False</span>

<span class="k">if</span> <span class="n">connected</span><span class="p">:</span>
    <span class="c1"># run experiment and record data locally</span>
    <span class="kn">from</span> <span class="nn">tclab</span> <span class="kn">import</span> <span class="n">TCLab</span><span class="p">,</span> <span class="n">clock</span><span class="p">,</span> <span class="n">Historian</span><span class="p">,</span> <span class="n">Plotter</span>
    <span class="k">with</span> <span class="n">TCLab</span><span class="p">()</span> <span class="k">as</span> <span class="n">lab</span><span class="p">:</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">Historian</span><span class="p">(</span><span class="n">lab</span><span class="o">.</span><span class="n">sources</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">Plotter</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">t_expt</span><span class="p">)</span>
        <span class="n">lab</span><span class="o">.</span><span class="n">P1</span> <span class="o">=</span> <span class="mi">200</span>
        <span class="n">lab</span><span class="o">.</span><span class="n">U1</span> <span class="o">=</span> <span class="mi">50</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">clock</span><span class="p">(</span><span class="n">t_expt</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">lab</span><span class="o">.</span><span class="n">T1</span><span class="p">)</span>
            <span class="n">p</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

    <span class="n">h</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">data_file</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># download previously recorded data from repository</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://jckantor.github.io/cbe30338-2021/&quot;</span> <span class="o">+</span> <span class="n">data_file</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Peak Temperature = </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;T1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/02.03-First-Order-Model-for-a-Single-Heater_9_0.png" src="../_images/02.03-First-Order-Model-for-a-Single-Heater_9_0.png" />
</div>
</div>
<p><img alt="" src="https://jckantor.github.io/cbe30338-2021/figures/Model_Data_Image.jpg" /></p>
<p>Under these conditions, starting with an ambient temperature of 21 C, when the system reached steady-state the measured voltage was 5.10 volts with a current of 0.315 amps, or 1.61 watts, resulting in a peak temperature of 53 C</p>
<div class="math notranslate nohighlight">
\[\alpha P_1 u_1 = 1.6 \text{ watts} \implies \alpha = \frac{1.6\text{watts}}{200 \times 50} = 0.00016 \frac{\text{watts}}{\text{units P1} \times \text{percent U1}}\]</div>
<hr>
<p><strong>Study Question:</strong> What is the maximum power that could be delivered to the heater/sensor assembly?</p>
<hr></div>
<div class="section" id="steady-state">
<h3><span class="section-number">2.3.2.6. </span>Steady State<a class="headerlink" href="#steady-state" title="Permalink to this headline">¶</a></h3>
<p>We’ll begin our analysis by investigating the steady-state response of this system to a steady-state input <span class="math notranslate nohighlight">\(\bar{u}_{1}\)</span>.  At steady-state all variables are constant so <span class="math notranslate nohighlight">\(\frac{dT_1}{dt} = 0\)</span>, which leaves</p>
<div class="math notranslate nohighlight">
\[\begin{align}
0 = U_a(T_{amb} - \bar{T}_1) + \alpha P_1\bar{u}_{1}
\end{align}\]</div>
<p>Solving for <span class="math notranslate nohighlight">\(\bar{T}_{1}\)</span></p>
<div class="math notranslate nohighlight">
\[\bar{T}_{1} = T_{amb} + \frac{\alpha P_1}{U_a}\bar{u}_{1}\]</div>
<hr>
<p><strong>Study Question:</strong> In the cell below, write Python code to estimate the value of <span class="math notranslate nohighlight">\(U_a\)</span>.</p>
<p><strong>Study Question:</strong> Using the results of this calculation, estimate the maximum acheivable temperature with this device.</p>
<hr></div>
<div class="section" id="deviation-variables">
<h3><span class="section-number">2.3.2.7. </span>Deviation Variables<a class="headerlink" href="#deviation-variables" title="Permalink to this headline">¶</a></h3>
<p>In examining the response of the temperature control laboratory, we see the temperature is a deviation from ambient temperature, i.e.,</p>
<div class="math notranslate nohighlight">
\[\begin{align}
T_1' = T_1 - T_{amb}
\end{align}\]</div>
<p>For process control purposes, we are often interested in the deviation of a process variable from a nominal value. In this case the choice of deviation variable is clearly obvious which is designated <span class="math notranslate nohighlight">\(T_1'\)</span>. From the steady state equation we see</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\bar{T}_1' = \bar{T}_1 - T_{amb} = \frac{\alpha P_1}{U_a}\bar{u}_1
\end{align}\]</div>
<p>which is a somewhat simpler expression.</p>
<p>Let’s see what happens to the transient model. Substituting <span class="math notranslate nohighlight">\(T_1 = T_{amb} + T_1'\)</span> into the differential equation gives</p>
<div class="math notranslate nohighlight">
\[\begin{align}
C_p\frac{d(T_{amb}+T_1')}{dt} &amp; = U_a(T_{amb} - (T_{amb} + T_1')) + \alpha P_1u_1
\end{align}\]</div>
<p>Expanding these terms</p>
<div class="math notranslate nohighlight">
\[\begin{align}
C_p\underbrace{\frac{dT_{amb}}{dt}}_{0} + C_p\frac{dT_1'}{dt} &amp; = U_a(\underbrace{T_{amb} - T_{amb}}_{0} - T_1') + \alpha P_1u_1
\end{align}\]</div>
<p>we see several terms drop out. The derivative of any constant is zero, and see a cancelation on the right hand side, leaving</p>
<div class="math notranslate nohighlight">
\[\begin{align}
C_p\frac{dT_1'}{dt} &amp; = - U_aT_1' + \alpha P_1u_1
\end{align}\]</div>
<p>One last manipulation will bring this model into a commonly used standard form</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{dT_1'}{dt} &amp; = - \frac{U_a}{C_p}T_1' + \frac{\alpha P_1}{C_p}u_1
\end{align}\]</div>
<hr>
<p><strong>Study Question:</strong> Previously we estimated <span class="math notranslate nohighlight">\(U_a\)</span> and <span class="math notranslate nohighlight">\(\alpha\)</span> from steady-state measurements. Can <span class="math notranslate nohighlight">\(C_p\)</span> be estimated from steady-state measurements? Why or why not?</p>
<hr></div>
<div class="section" id="first-order-linear-differential-equations">
<h3><span class="section-number">2.3.2.8. </span>First Order Linear Differential Equations<a class="headerlink" href="#first-order-linear-differential-equations" title="Permalink to this headline">¶</a></h3>
<p>A standard form for a single differential equation is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\frac{dx}{dt} &amp; = ax + bu
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are model constants, <span class="math notranslate nohighlight">\(x\)</span> is the dependent variable, and <span class="math notranslate nohighlight">\(u\)</span> is an exogeneous input.</p>
<div class="section" id="steady-state-response">
<h4><span class="section-number">2.3.2.8.1. </span>Steady State Response<a class="headerlink" href="#steady-state-response" title="Permalink to this headline">¶</a></h4>
<p>For a constant value <span class="math notranslate nohighlight">\(\bar{u}\)</span>, the steady state response <span class="math notranslate nohighlight">\(\bar{x}\)</span> is given by solution to the equation</p>
<div class="math notranslate nohighlight">
\[\begin{align}
0 &amp; = a\bar{x} + b\bar{u}
\end{align}\]</div>
<p>which is</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\bar{x} &amp; = -\frac{b}{a} \bar{u}
\end{align}\]</div>
</div>
<div class="section" id="transient-response">
<h4><span class="section-number">2.3.2.8.2. </span>Transient Response<a class="headerlink" href="#transient-response" title="Permalink to this headline">¶</a></h4>
<p>The transient response is given by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
x(t) &amp; = \bar{x} + \left[x(t_0) - \bar{x}\right] e^{a(t-t_0)}
\end{align}\]</div>
<p>which is an exact, analytical solution.</p>
</div>
<div class="section" id="apply-to-model-equation">
<h4><span class="section-number">2.3.2.8.3. </span>Apply to Model Equation<a class="headerlink" href="#apply-to-model-equation" title="Permalink to this headline">¶</a></h4>
<p>We now apply this textbook solution to the model equation. Comparing equations, we make the following identifications</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
T_1' \sim x \\
-\frac{U_a}{C_p} \sim a \\
\frac{\alpha P_1}{C_p} \sim b \\
u_1 \sim u
\end{align}\end{split}\]</div>
<p>Substituting these terms into the standard solution we confirm the steady-state solution found above, and provides a solution for the transient response of the deviation variables.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\bar{x} = -\frac{b}{a}\bar{u} \qquad &amp; \Rightarrow \qquad \bar{T}_{1}' = \frac{\alpha P_1}{U_a}\bar{u}_{1} \\
x(t) = \bar{x} + \left[x(t_0) - \bar{x}\right] e^{a(t-t_0)} \qquad &amp; \Rightarrow \qquad
T_1'(t) = \frac{\alpha P_1}{U_a}\bar{u}_{1} + \left[T_1'(t_0) - \frac{\alpha P_1}{U_a}\bar{u}_{1}\right]e^{-\frac{U_a}{C_p}(t-t_0)}
\end{align}\end{split}\]</div>
</div>
</div>
<div class="section" id="plotting-the-analytical-solution">
<h3><span class="section-number">2.3.2.9. </span>Plotting the Analytical Solution<a class="headerlink" href="#plotting-the-analytical-solution" title="Permalink to this headline">¶</a></h3>
<p>The following cell demonstrates use of these results to plot the transient response for a particular choice of model parameters.</p>
<p>The steady state analysis provided an estimate for the gross heat transfer coefficient <span class="math notranslate nohighlight">\(U_a\)</span>. Rerun this cell for different values of gross heat capacity <span class="math notranslate nohighlight">\(C_p\)</span>. Try to find a value that at least mimics the experimental response shown above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># parameter values and units</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.00016</span>        <span class="c1"># watts / (units P1 * percent U1)</span>
<span class="n">P1</span> <span class="o">=</span> <span class="mi">200</span>               <span class="c1"># P1 units</span>
<span class="n">Ua</span> <span class="o">=</span> <span class="mf">0.05</span>              <span class="c1"># watts/deg C</span>
<span class="n">Cp</span> <span class="o">=</span> <span class="mi">6</span>                 <span class="c1"># joules/deg C</span>
<span class="n">U1</span> <span class="o">=</span> <span class="mi">50</span>                <span class="c1"># steady state value of u1 (percent)</span>
<span class="n">T_amb</span> <span class="o">=</span> <span class="mi">21</span>             <span class="c1"># deg C</span>

<span class="c1"># initial conditions</span>
<span class="n">T1_dev_initial</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># steady state solution</span>
<span class="n">T1_dev_ss</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">*</span><span class="n">P1</span><span class="o">*</span><span class="n">U1</span><span class="o">/</span><span class="n">Ua</span>

<span class="c1"># compute the transient solution</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">T1_dev</span> <span class="o">=</span> <span class="n">T1_dev_ss</span> <span class="o">+</span> <span class="p">(</span><span class="n">T1_dev_initial</span> <span class="o">-</span> <span class="n">T1_dev_ss</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Ua</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">Cp</span><span class="p">)</span>

<span class="c1"># plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">T1_dev</span> <span class="o">+</span> <span class="n">T_amb</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time / seconds&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;temperature / °C&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/02.03-First-Order-Model-for-a-Single-Heater_19_0.png" src="../_images/02.03-First-Order-Model-for-a-Single-Heater_19_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="matching-the-model-to-experimental-data">
<h2><span class="section-number">2.3.3. </span>Matching the Model to Experimental Data<a class="headerlink" href="#matching-the-model-to-experimental-data" title="Permalink to this headline">¶</a></h2>
<p>The following cell provides an interactive tool for ‘tuning’ the model to fit the experimental data. Work with the sliders to find good choices for each of the parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">data_file</span> <span class="o">=</span> <span class="s2">&quot;data/Model_Data.csv&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://jckantor.github.io/cbe30338-2021/&quot;</span> <span class="o">+</span> <span class="n">data_file</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span>
<span class="n">T1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;T1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># parameter values and units</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.00016</span>        <span class="c1"># watts / (units P1 * percent U1)</span>
<span class="n">P1</span> <span class="o">=</span> <span class="mi">200</span>               <span class="c1"># P1 units</span>
<span class="n">Ua</span> <span class="o">=</span> <span class="mf">0.05</span>              <span class="c1"># watts/deg C</span>
<span class="n">Cp</span> <span class="o">=</span> <span class="mi">6</span>                 <span class="c1"># joules/deg C</span>
<span class="n">U1</span> <span class="o">=</span> <span class="mi">50</span>                <span class="c1"># steady state value of u1 (percent)</span>
<span class="n">T_amb</span> <span class="o">=</span> <span class="mi">21</span>             <span class="c1"># deg C</span>

<span class="k">def</span> <span class="nf">compare</span><span class="p">(</span><span class="n">Ua</span><span class="p">,</span> <span class="n">Cp</span><span class="p">):</span>
    <span class="n">T1_dev_initial</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">T1_dev_ss</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">*</span><span class="n">P1</span><span class="o">*</span><span class="n">U1</span><span class="o">/</span><span class="n">Ua</span>
    <span class="n">T1_dev</span> <span class="o">=</span> <span class="n">T1_dev_ss</span> <span class="o">+</span> <span class="p">(</span><span class="n">T1_dev_initial</span> <span class="o">-</span> <span class="n">T1_dev_ss</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Ua</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">Cp</span><span class="p">)</span>
    <span class="n">T1_model</span> <span class="o">=</span> <span class="n">T1_dev</span> <span class="o">+</span> <span class="n">T_amb</span>
    
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">T1</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">T1_model</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time / seconds&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;temperture / °C&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Ua = </span><span class="si">{</span><span class="n">Ua</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Cp = </span><span class="si">{</span><span class="n">Cp</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">T1_model</span> <span class="o">-</span> <span class="n">T1</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Sum of errors = </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">T1_model</span><span class="o">-</span><span class="n">T1</span><span class="p">))</span><span class="si">:</span><span class="s1">0.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">compare</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/02.03-First-Order-Model-for-a-Single-Heater_21_0.png" src="../_images/02.03-First-Order-Model-for-a-Single-Heater_21_0.png" />
</div>
</div>
<hr>
<p><strong>Study Question:</strong> By trial and error using the <code class="docutils literal notranslate"><span class="pre">compare()</span></code> function defined above, tetermine values for <span class="math notranslate nohighlight">\(U_a\)</span> and <span class="math notranslate nohighlight">\(C_p\)</span> that yield a good fit of the model to the data.</p>
<p><strong>Study Question:</strong> Are you able to remove all systematic error? If not, why not?</p>
<p><strong>Study Question:</strong> The sum of absolute errors is shown on the chart. Try to find values of <span class="math notranslate nohighlight">\(U_a\)</span> and <span class="math notranslate nohighlight">\(C_p\)</span> that minimize this error criterion. In your opinion, is that the best choice of model parameters? Why or why not?</p>
<p><strong>Study Question:</strong> Does this solution make sense? The <a class="reference external" href="https://en.wikipedia.org/wiki/Heat_capacity">specific heat capacity for solids</a> is typically has values in the range of 0.2 to 0.9 watts/degC/gram. Using a value of 0.9 that is typical of aluminum and plastics used for electronic products, what would be the estimated mass of the heater/sensor combination?</p>
<p><strong>Study Question:</strong> Suppose we want to improve the model. Where should we go from here?</p>
<hr></div>
<div class="section" id="assignment-3">
<h2><span class="section-number">2.3.4. </span>Assignment 3<a class="headerlink" href="#assignment-3" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>This notebook attempted to fit a first-order model of a heater/sensor assembly to experimental data. In the course of the fit, estimates were derived for parameters <span class="math notranslate nohighlight">\(\alpha\)</span>, P1, <span class="math notranslate nohighlight">\(U_a\)</span>, and <span class="math notranslate nohighlight">\(C_p\)</span>. From these parameter values, estimate a time constant.</p></li>
<li><p>Apply the techniques outlined in Section 2.2 for the estimation of time constants from experimental data. How does that value compare to the calculation in the first question?</p></li>
<li><p>One idea to improve the fit of the model to the data would be add an additional adjustable parameter. Suppose we assume <span class="math notranslate nohighlight">\(T_amb\)</span> isn’t measured. Create a new notebook. Based on the code cell above where the function <code class="docutils literal notranslate"><span class="pre">compare</span></code> is defined, create a new function called <code class="docutils literal notranslate"><span class="pre">compare3</span></code> that takes accepts parameters <span class="math notranslate nohighlight">\(T_amb\)</span>, <span class="math notranslate nohighlight">\(Ua\)</span>, and <span class="math notranslate nohighlight">\(Cp\)</span> and compares prediction to experimental data. By trial and error, find values of the three parameters that best ‘fit’ the data.  Were you able to reduce the structural error in the model? Discuss your result.</p></li>
</ol>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="02.02-Properties-of-Scalar-First-Order-Linear-Systems.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">2.2. </span>Properties of Scalar First Order Linear Systems</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="02.04-Model-Identification.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2.4. </span>Model Identification for the Temperature Control Lab</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Jeffrey Kantor<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>